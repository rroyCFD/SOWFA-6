#!/bin/bash

source ./.bash_profile_OFv6
echo $SOWFA_DIR

SOWFA_SRC=$SOWFA_DIR"/src"
echo $SOWFA_SRC

SOWFA_APP=$SOWFA_DIR"/applications"
echo $SOWFA_APP

################################################################################
## Build sources
cd $SOWFA_SRC

# Turbulence models.
cd TurbulenceModels/
./Allwmake
cd $SOWFA_SRC

# # Actuator turbine models.
# cd turbineModels/turbineModelsStandard
# wmake libso
# cd $SOWFA_SRC


# # # OpenFAST coupled turbine models.
# # if [ -z ${OPENFAST_DIR+x} ]
# # then
# #     echo "OPENFAST_DIR is not set. Not compiling OpenFAST interface."
# # else
# #     if [ -d ${OPENFAST_DIR} ]
# #     then
# # 	echo "OPENFAST_DIR is set to '${OPENFAST_DIR}'. Attempting to compile OpenFAST interface."
# # 	cd src/turbineModels/turbineModelsOpenFAST
# # 	wmake libso
# # 	cd ../../../
# #     else
# # 	echo "OPENFAST_DIR is set to '${OPENFAST_DIR}'. Directory doesn't exist or I can't access it. Skipping compilation of OpenFAST interface."
# #     fi
# # fi

# Custom mesh Tools
cd meshTools
wmake libso
cd $SOWFA_SRC


# ABL forcing objects
cd ABLForcing
wmake libso
cd $SOWFA_SRC


# Custom sampling (this includes sampling on an annulus).
cd sampling
wmake libso
cd $SOWFA_SRC


# Custom file formats (like structured VTK).
cd fileFormats
wmake libso
cd $SOWFA_SRC


# Custom boundary conditions.
cd boundaryConditions
wmake libso
cd $SOWFA_SRC


# Custom function objects (this includes planar and temporal averaging).
cd functionObjects/field
wmake libso
cd $SOWFA_SRC


# Custom function objects (this includes the lidar sampling).
cd functionObjects/utilities
wmake libso
cd $SOWFA_SRC

################################################################################
## Build applications
cd $SOWFA_APP

# Utility to set the initial fields for the ABL solver.
cd utilities/setFieldsABL
wmake
cd $SOWFA_APP

cd utilities/writeCellCenters
wmake
cd $SOWFA_APP

cd solvers/superDeliciousVanilla
wmake
cd $SOWFA_APP

# cd solvers/superDeliciousVanilla.turbine
# wmake
# cd $SOWFA_APP


cd $SOWFA_DIR